<!DOCTYPE html>
<html>
<head>
	<title>WebGL Cube</title>
	<script src="../webgl.js"></script>
	<script src="gl-matrix-min.js"></script>
</head>
<body>
	<script id="vert-shader" type="text/plain">
		attribute vec3 aPos;
		uniform mat4 uView;
		uniform mat4 uProj;
		varying vec3 vPos;
		
		void main()
		{
			vPos = aPos;
			gl_Position = uProj * uView * vec4(aPos, 1);
		}
	</script>
	<script id="frag-shader" type="text/plain">
		varying highp vec3 vPos;
		
		void main()
		{
			gl_FragColor = vec4(vPos, 1);
		}
	</script>
	<script>
		var gl = webgl(400, 400, render, "appendToBody", "no-antialias");

		gl.enable(gl.CULL_FACE);
		gl.enable(gl.DEPTH_TEST);
		
		var buffer = gl.buffer([
			0,0,0, 1,0,0, 0,1,0, 1,1,0,
			0,0,1, 1,0,1, 0,1,1, 1,1,1,
		]);
		
		var indices = gl.buffer("index", [
			0,1,2, 2,1,3, // front
			5,4,7, 7,4,6, // back
			4,0,6, 6,0,2, // left
			1,5,3, 3,5,7, // right
			2,3,6, 6,3,7, // top
			4,5,0, 0,5,1, // bottom
		]);
		
		var shader = gl.shader("#vert-shader", "#frag-shader");
		var proj = mat4.perspective(mat4.create(), glMatrix.toRadian(45), 1, 0.1, 100);
		var rot = 0;
		
		function render()
		{
			var view = mat4.create();
		
			mat4.scale(view, view, [1, 1, -1]);
			mat4.translate(view, view, [0, 0, 3]);
			mat4.rotateX(view, view, rot * 0.0482);
			mat4.rotateY(view, view, rot * 0.0916);
			mat4.rotateZ(view, view, rot * 0.0373);
			mat4.translate(view, view, [-0.5, -0.5, -0.5]);
			rot += 0.125;
			
			shader.draw({
				indices: indices,
				aPos: buffer,
				uView: view,
				uProj: proj,
			});
		}
	</script>
</body>
</html>
